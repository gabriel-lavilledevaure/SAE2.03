let templateFile = await fetch("./component/MovieReco/template.html");
let template = await templateFile.text();

let MovieReco = {};

MovieReco.format = function (movies) {
  if (!movies.length) return "";

  let cards = "";
  for (let index = 0; index < movies.length; index++) {
    const movie = movies[index];
    const image = movie.image ?? "placeholder.jpg";
    const name = movie.name ?? "Sans titre";
    const age = movie.min_age ?? "N.C";
    const year = movie.year ?? "????";
    const category = movie.category_name ?? "Inconnu";
    const description = movie.description ?? "Aucune description disponible.";
    const trailer = movie.trailer ?? "Aucune trailer disponible.";
    cards += `
    <div class="reco__card" style="background-image: url('../server/images/${image}')">
      <div class="reco__content">
        <h3 class="reco__name">${name}</h3>
        <a class="reco__trailer" href="${trailer}" target="_blank">
<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
  <path d="M29.8667 15.9999V20.2666C29.8667 20.5495 29.7543 20.8208 29.5542 21.0209C29.3542 21.2209 29.0829 21.3333 28.8 21.3333C28.5171 21.3333 28.2458 21.2209 28.0457 21.0209C27.8457 20.8208 27.7333 20.5495 27.7333 20.2666C27.7333 20.2666 27.8613 19.1999 25.6 19.1999H23.4667V24.5333C23.4667 24.8162 23.3543 25.0875 23.1542 25.2875C22.9542 25.4876 22.6829 25.5999 22.4 25.5999H5.33333C5.05043 25.5999 4.77912 25.4876 4.57908 25.2875C4.37904 25.0875 4.26666 24.8162 4.26666 24.5333V15.9999C4.26666 15.717 4.37904 15.4457 4.57908 15.2457C4.77912 15.0456 5.05043 14.9333 5.33333 14.9333H22.4C22.6829 14.9333 22.9542 15.0456 23.1542 15.2457C23.3543 15.4457 23.4667 15.717 23.4667 15.9999V17.0666H25.6C27.8613 17.0666 27.7333 15.9999 27.7333 15.9999C27.7333 15.717 27.8457 15.4457 28.0457 15.2457C28.2458 15.0456 28.5171 14.9333 28.8 14.9333C29.0829 14.9333 29.3542 15.0456 29.5542 15.2457C29.7543 15.4457 29.8667 15.717 29.8667 15.9999ZM8.53333 6.39994C7.40174 6.39994 6.3165 6.84946 5.51634 7.64961C4.71618 8.44977 4.26666 9.53501 4.26666 10.6666C4.26666 11.7982 4.71618 12.8834 5.51634 13.6836C6.3165 14.4837 7.40174 14.9333 8.53333 14.9333C9.66492 14.9333 10.7502 14.4837 11.5503 13.6836C12.3505 12.8834 12.8 11.7982 12.8 10.6666C12.8 9.53501 12.3505 8.44977 11.5503 7.64961C10.7502 6.84946 9.66492 6.39994 8.53333 6.39994ZM8.53333 12.7999C7.96753 12.7999 7.42491 12.5752 7.02483 12.1751C6.62476 11.775 6.4 11.2324 6.4 10.6666C6.4 10.1008 6.62476 9.55819 7.02483 9.15811C7.42491 8.75803 7.96753 8.53327 8.53333 8.53327C9.09912 8.53327 9.64175 8.75803 10.0418 9.15811C10.4419 9.55819 10.6667 10.1008 10.6667 10.6666C10.6667 11.2324 10.4419 11.775 10.0418 12.1751C9.64175 12.5752 9.09912 12.7999 8.53333 12.7999ZM18.1333 4.2666C16.7188 4.2666 15.3623 4.8285 14.3621 5.8287C13.3619 6.82889 12.8 8.18545 12.8 9.59994C12.8 11.0144 13.3619 12.371 14.3621 13.3712C15.3623 14.3714 16.7188 14.9333 18.1333 14.9333C19.5478 14.9333 20.9044 14.3714 21.9046 13.3712C22.9048 12.371 23.4667 11.0144 23.4667 9.59994C23.4667 8.18545 22.9048 6.82889 21.9046 5.8287C20.9044 4.8285 19.5478 4.2666 18.1333 4.2666ZM18.1333 12.7999C17.2846 12.7999 16.4707 12.4628 15.8706 11.8627C15.2705 11.2626 14.9333 10.4486 14.9333 9.59994C14.9333 8.75124 15.2705 7.93731 15.8706 7.33719C16.4707 6.73708 17.2846 6.39994 18.1333 6.39994C18.982 6.39994 19.796 6.73708 20.3961 7.33719C20.9962 7.93731 21.3333 8.75124 21.3333 9.59994C21.3333 10.4486 20.9962 11.2626 20.3961 11.8627C19.796 12.4628 18.982 12.7999 18.1333 12.7999Z"
  />
</svg>
          <span class="reco__trailerbtn">Trailer</span>
        </a>
      </div>
    </div>
  `;
  }

  return template.replace("{{cards}}", cards);
};

export { MovieReco };
